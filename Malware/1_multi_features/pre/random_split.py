import glob
import os
import numpy
import shutil
import pandas as pd
import random
import numpy as np
# This is used for multithreading
import multiprocessing
from multiprocessing import Process

# This is used for file operations
import codecs

def random_split(asm_path):
    # Intially create five folders
    # first, second, third, fourth, fifth
    # This code tells us about random split of files into five folders
    # 分为五个部分，后面用多线程加快处理速度
    os.chdir(asm_path)
    folder_1 = 'first'
    folder_2 = 'second'
    folder_3 = 'third'
    folder_4 = 'fourth'
    folder_5 = 'fifth'
    folder_6 = 'output'
    for i in [folder_1, folder_2, folder_3, folder_4, folder_5, folder_6]:
        if not os.path.isdir(i):
            os.makedirs(i)


    files = glob.glob("*.asm")

    data = list(range(0, len(files)))
    random.shuffle(data)
    count = 0
    for i in range(0, len(files)):
        if i % 5 == 0:
            shutil.move(files[data[i]], 'first')
        elif i % 5 == 1:
            shutil.move(files[data[i]], 'second')
        elif i % 5 == 2:
            shutil.move(files[data[i]], 'third')
        elif i % 5 == 3:
            shutil.move(files[data[i]], 'fourth')
        elif i % 5 == 4:
            shutil.move(files[data[i]], 'fifth')

if __name__ == "__main__":
    asm_path = r"D:\research\datasets\3_malware\CCF_1_data_set\test\asm"
    # csv_path = r"D:\research\datasets\3_malware\CCF_1_data_set\train_set\train_label.csv"
    random_split(asm_path)